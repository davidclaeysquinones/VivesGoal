//Deel van de gewijzigde methodes 
//toevoegenPloeg(PloegBag p)
//verwijderPloeg(PloegBag p)
//verwijderPloeg(int ploegid)
//verwijderPloeg(String naam)
//verwijderAllePloegen()
 
 //Ruben
   public void toevoegenPloeg(PloegBag p) throws DBException {

      // connectie tot stand brengen (en automatisch sluiten)
      try (Connection conn = ConnectionManager.getConnection();) {
         // preparedStatement opstellen (en automtisch sluiten)
         try (PreparedStatement stmt = conn.prepareStatement(
            "INSERT INTO ploeg (`naam`, `niveau`, `trainer_id`) VALUES (?,?,?)");) {
            stmt.setString(1, p.getNaam());
            stmt.setString(2, p.getCategorie().getTekst());
            stmt.setInt(3,p.getTrainer());
            
            stmt.execute();

            
         } catch (SQLException sqlEx) {
            throw new DBException("SQL-exception in toevoegenPloeg(PloegBag p) - statement"+ sqlEx);
         }
      } catch (SQLException sqlEx) {
         throw new DBException(
            "SQL-exception in toevoegenPloeg(PloegBag p) - connection"+ sqlEx);
      }

   }

   //Ruben
   public void verwijderPloeg(PloegBag p) throws DBException {

      // connectie tot stand brengen (en automatisch sluiten)
      try (Connection conn = ConnectionManager.getConnection();) {
         // preparedStatement opstellen (en automtisch sluiten)
         try (PreparedStatement stmt = conn.prepareStatement(
            "update persoon set ploeg_id = NULL where ploeg_id = ?");) {
            stmt.setInt(1, p.getId());      
            stmt.execute();      
         } 
          // preparedStatement opstellen (en automtisch sluiten)
         try (PreparedStatement stmt = conn.prepareStatement(
            "delete from ploeg where id=?");) {
            stmt.setInt(1, p.getId());
           
            
            stmt.execute();      
         }
         catch (SQLException sqlEx) {
            throw new DBException("SQL-exception in verwijderPloeg(PloegBag p) - statement"+ sqlEx);
         }
      } catch (SQLException sqlEx) {
         throw new DBException(
            "SQL-exception in verwijderPloeg(PloegBag p) - connection"+ sqlEx);
      }

   }
   
   //Ruben
   public void verwijderPloeg(int ploegid) throws DBException {

      // connectie tot stand brengen (en automatisch sluiten)
      try (Connection conn = ConnectionManager.getConnection();) {
         // preparedStatement opstellen (en automtisch sluiten)
         try (PreparedStatement stmt = conn.prepareStatement(
            "update persoon set ploeg_id = NULL where ploeg_id = ?");) {
            stmt.setInt(1, ploegid);      
            stmt.execute();      
         } 
          // preparedStatement opstellen (en automtisch sluiten)
         try (PreparedStatement stmt = conn.prepareStatement(
            "delete from ploeg where id=?");) {
            stmt.setInt(1, ploegid);
           
            
            stmt.execute();      
         }
         catch (SQLException sqlEx) {
            throw new DBException("SQL-exception in verwijderPloeg(int ploegid) - statement"+ sqlEx);
         }
      } catch (SQLException sqlEx) {
         throw new DBException(
            "SQL-exception in verwijderPloeg(int ploegid) - connection"+ sqlEx);
      }

   }

   // Ruben
   public void verwijderPloeg(String naam) throws DBException {

      // connectie tot stand brengen (en automatisch sluiten)
      try (Connection conn = ConnectionManager.getConnection();) {
         // preparedStatement opstellen (en automtisch sluiten)
         try (PreparedStatement stmt = conn.prepareStatement(
            "update persoon set ploeg_id = NULL where ploeg in (select id from ploeg where naam=?)");) {
            stmt.setString(1, naam);      
            stmt.execute();      
         } 
          // preparedStatement opstellen (en automtisch sluiten)
         try (PreparedStatement stmt = conn.prepareStatement(
            "delete from ploeg where naam=?");) {
            stmt.setString(1, naam);
           
            
            stmt.execute();      
         }
         catch (SQLException sqlEx) {
            throw new DBException("SQL-exception in verwijderPloeg(String naam) - statement"+ sqlEx);
         }
      } catch (SQLException sqlEx) {
         throw new DBException(
            "SQL-exception in verwijderPloeg(String naam) - connection"+ sqlEx);
      }

   }
// Ruben
//   debugged
   public void verwijderAllePloegen() throws DBException {

      // connectie tot stand brengen (en automatisch sluiten)
      try (Connection conn = ConnectionManager.getConnection();) {
         // preparedStatement opstellen (en automtisch sluiten)
         try (PreparedStatement stmt = conn.prepareStatement(
            "update persoon set ploeg_id = NULL");) {
             
            stmt.execute();      
         } 
          // preparedStatement opstellen (en automtisch sluiten)
         try (PreparedStatement stmt = conn.prepareStatement(
            "delete from ploeg ");) {
            
           
            
            stmt.execute();      
         }
         catch (SQLException sqlEx) {
            throw new DBException("SQL-exception in toevoegenPloeg(PloegBag p) - statement"+ sqlEx);
         }
      } catch (SQLException sqlEx) {
         throw new DBException(
            "SQL-exception in toevoegenPloeg(PloegBag p) - connection"+ sqlEx);
      }

   }
